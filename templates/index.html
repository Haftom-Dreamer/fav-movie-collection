{% extends 'bootstrap/base.html' %}
{% block styles %}
  {{ super() }}
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Poppins', sans-serif;
      background-color: #c03434;
      color: #f5f5f5;
    }

    .navbar {
      background-color: #1f1f1f;
      padding: 1rem 2rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .navbar h1 {
      margin: 0;
      font-size: 1.5rem;
    }

    .navbar a {
      text-decoration: none;
      background-color: #e50914;
      color: white;
      padding: 8px 16px;
      border-radius: 5px;
      font-weight: bold;
      transition: background-color 0.3s;
    }

    .navbar a:hover {
      background-color: #b00710
    }

   .movie-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(260px, 1fr)); /* wider cards */
  gap: 28px;
  padding: 2rem;
}

.movie-card {
  background-color: transparent;
  border-radius: 10px;
  perspective: 1000px;
  height: 460px;           /* Increased height */
  width: 100%;
  box-sizing: border-box;
  margin: 0 auto;
  transition: transform 0.2s cubic-bezier(.4,2,.6,1);
}

.movie-card:hover {
  transform: scale(1.04) translateY(-8px);
  box-shadow: 0 8px 32px rgba(0,0,0,0.3);
  z-index: 2;
}

    .flip-card-inner {
      position: relative;
      width: 100%;
      height: 100%;
      transition: transform 0.6s;
      transform-style: preserve-3d;
    }

    .flip-card-inner.flipped {
      transform: rotateY(180deg);
    }

    .flip-card-front, .flip-card-back {
  position: absolute;
  width: 100%;
  height: 100%;
  backface-visibility: hidden;
  border-radius: 10px;
  overflow: hidden;
  box-shadow: 0 0 10px rgba(0,0,0,0.3);
  background-color: #1e1e1e;
  display: flex;
  flex-direction: column;
  justify-content: flex-start;
}

.flip-card-front img {
  width: 100%;
  height: 360px;           /* Bigger image */
  object-fit: cover;       /* Ensures the poster fits perfectly */
  border-bottom: 1px solid #232323;
}

.flip-card-front .card-content,
.flip-card-back .card-content {
  padding: 1rem 1.1rem;
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  justify-content: flex-start;
  gap: 0.6rem;
  width: 100%;
  min-height: 100px;
}


    /* .flip-card-front {
      z-index: 2;
    } */

    .flip-card-back {
  background-color: #232323;
  color: #fff;
  transform: rotateY(180deg);
  z-index: 3;
  display: flex;
  flex-direction: column;
  justify-content: flex-start;
  align-items: flex-start;
}

    /* .flip-card-back .btn-group {
  display: flex;
  gap: 0.5rem;
  margin-top: 1rem;
  flex-wrap: wrap;
} */

.flip-card-back .card-content {
  height: 100%;
  min-height: 0;
  width: 100%;
  display: flex;
  flex-direction: column;
  justify-content: center;   /* Center content vertically */
  align-items: flex-start;
  gap: 1rem;
  padding: 1.2rem 1.1rem;
  box-sizing: border-box;
}

.flip-card-back .review,
.flip-card-back .description {
  font-size: 1.2rem;
  color: #fff;
  background: #181818;
  padding: 0.5rem 0.7rem;
  border-radius: 6px;
  width: 100%;
  word-break: break-word;
  margin-bottom: 0.4rem;
  box-shadow: 0 2px 8px rgba(0,0,0,0.2);
}

    .movie-card .title {
      font-size: 1.1rem;
      font-weight: 600;
    }

    .movie-card .rating {
      color: gold;
      font-weight: 500;
      margin: 0.3rem 0;
    }

    .movie-card .review {
      font-size: 0.9rem;
      color: #ccc;
    }

    .btn-group {
  display: flex;
  flex-wrap: wrap;
  gap: 0.4rem;
  margin-top: 0.5rem;
  justify-content: flex-start;
}
    .btn-group a, .btn-group button {
  margin: 0;
  min-width: 70px;
  font-size: 0.95rem;
  white-space: nowrap;
}
.btn-secondary {
  background-color: #fff !important;
  color: #232323 !important;
  border: none;
}
  </style>
{% endblock %}

{% block content %}
<div class="navbar">
  <h1 style="font-size: 2.5rem;">üé¨ My Movie Collection</h1>
  <a href="{{ url_for('add') }}">+ Add Movie</a>
</div>

<div class="movie-grid">
  {% for movie in movies %}
  <div class="movie-card">
    <div class="flip-card-inner" id="flip-{{ movie.id }}">
      <div class="flip-card-front">
        <img src="{{ movie.img_url }}" alt="{{ movie.title }}">
        <div class="card-content">
          <div class="title">{{ movie.title }} ({{ movie.year }})</div>
          <div class="rating">‚≠ê {{ movie.rating }}</div>
          <div class="btn-group">
            <a href="{{ url_for('edit', movie_id=movie.id) }}" class="btn btn-sm btn-light">Edit</a>
            <a href="{{ url_for('delete', movie_id=movie.id) }}" class="btn btn-sm btn-danger">Delete</a>
            <button class="btn btn-sm btn-info" onclick="flipCard({{ movie.id }})">Details</button>
          </div>
        </div>
      </div>
      <div class="flip-card-back">
        <div class="card-content">
          <div class="title">{{ movie.title }} ({{ movie.year }})</div>
          <div class="review"><strong>Review:</strong> {{ movie.review }}</div>
          <div class="description"><strong>Description:</strong> {{ movie.description }}</div>
          <button class="btn btn-sm btn-secondary" onclick="flipCard({{ movie.id }})">Back</button>
        </div>
      </div>
    </div>
  </div>
  {% endfor %}
</div>

<script>
function flipCard(id) {
  const cardInner = document.getElementById('flip-' + id);
  cardInner.classList.toggle('flipped');
}
</script>
{% endblock %}